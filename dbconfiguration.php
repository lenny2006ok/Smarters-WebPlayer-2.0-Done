<?php
/*
 * @ https://EasyToYou.eu - IonCube v11 Decoder Online
 * @ PHP 7.2
 * @ Decoder version: 1.0.4
 * @ Release: 01/09/2021
 */

echo "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>DB Configuration</title>\r\n<link href=\"assets/css/bootstrap.min.css\" rel=\"stylesheet\">\r\n<style type=\"text/css\">\r\n\tbody {\r\n\t    background-color: #e2d1f1;\r\n\t}\r\n\t.fromcontainer {\r\n\t    padding: 15px;\r\n\t    background-color: #fff;\r\n\t}\r\n\t.addborder\r\n\t{\r\n\t\tborder: 1px solid red;\r\n\t}\r\n</style>\r\n</head>\r\n\t<body>\r\n\t\t";
$fileName = "dbinfo.php";
$configFileCheck = [];
if (file_exists($fileName)) {
    $Permission = substr(sprintf("%o", fileperms($fileName)), -4);
    $configFileCheck = ["result" => "success", "permission" => $Permission];
} else {
    $content = "";
    $fp = fopen("dbinfo.php", "w");
    fwrite($fp, $content);
    fclose($fp);
    chmod("dbinfo.php", 420);
}
echo "\r\n\t\t  \r\n\t\t<div class=\"container\">\r\n\t\t  \t<div class=\"row\" style=\"margin-top: 50px;\">\r\n\t\t  \t\t<div class=\"col-sm-12\">\r\n\t\t  \t\t\t<h2 style=\"text-align: center;\">\r\n\t\t\t  \t\t\tWEBTV PLAYER CONFIGURATION\r\n\t\t\t  \t\t</h2>\r\n\t\t  \t\t</div>\r\n\t\t    </div>\r\n\t\t  \t<div class=\"row\">\r\n\t\t  \t\t<div class=\"col-sm-3\">\t\t  \t\t\t\r\n\t\t  \t\t</div>\r\n\t\t  \t\t<div class=\"col-sm-6\">\t\r\n\t\t  \t\t\t";
if ($configFileCheck["permission"] == "0755" || $configFileCheck["permission"] == "0777") {
    echo "\t\t\t\t\t\t<div class=\"fromcontainer\">\r\n\t\t\t\t\t\t\t  <div class=\"form-group\">\r\n\t\t\t\t\t\t\t    <label for=\"hostname\">HOST Name:*</label>\r\n\t\t\t\t\t\t\t    <input type=\"text\" class=\"form-control commonclass\" id=\"hostname\">\r\n\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t\t  <div class=\"form-group\">\r\n\t\t\t\t\t\t\t    <label for=\"dbname\">DB Name:*</label>\r\n\t\t\t\t\t\t\t    <input type=\"text\" class=\"form-control commonclass\" id=\"dbname\">\r\n\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t\t  <div class=\"form-group\">\r\n\t\t\t\t\t\t\t    <label for=\"dbusername\">DB Username:*</label>\r\n\t\t\t\t\t\t\t    <input type=\"text\" class=\"form-control commonclass\" id=\"dbusername\">\r\n\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t\t  <div class=\"form-group\">\r\n\t\t\t\t\t\t\t    <label for=\"dbpassword\">DB Password:*</label>\r\n\t\t\t\t\t\t\t    <input type=\"password\" class=\"form-control commonclass\" id=\"dbpassword\">\r\n\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t\t  <div class=\"form-group\">\r\n\t\t\t\t\t\t\t    <label for=\"port\">PORT:</label>\r\n\t\t\t\t\t\t\t    <input type=\"text\" class=\"form-control\" id=\"port\">\r\n\t\t\t\t\t\t\t  </div>\r\n\t\t\t\t\t\t  \t\t<center>\r\n\t\t\t\t\t\t  \t\t\t<button type=\"submit\" class=\"btn btn-primary\" id=\"testandsave\" style=\"text-align: right;\">Test &amp; Save Changes</button>\r\n\t\t\t\t\t\t  \t\t</center>\t\r\n\t\t\t  \t\t\t</div>\r\n\t\t\t\t\t\t";
} else {
    echo "\t\t\t\t\t\t\t<p class=\"alert alert-warning\">Please Give Permission (777 or 755) to dbinfo.php to start configuration.</p>\r\n\t\t\t\t\t\t";
}
echo "\t  \t\t\t\r\n\t\t  \t\t</div>\r\n\t\t  \t\t<div class=\"col-sm-3\">\t\t  \t\t\t\r\n\t\t  \t\t</div>\r\n\t\t    </div>\r\n\t\t</div>\r\n\r\n\r\n\t\t<script src=\"assets/js/jquery-3.4.0.min.js\"></script> \r\n\t\t<script src=\"assets/js/bootstrap.min.js\"></script> \r\n\t\t<!-- <script src=\"https://unpkg.com/sweetalert/dist/sweetalert.min.js\"></script> -->\r\n\t\t<script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@9.4.0/dist/sweetalert2.all.min.js\" integrity=\"sha256-MkJEgSdrHobdNBZy1zd8me5EqoiOYs/tnRXyuJNsPIY=\" crossorigin=\"anonymous\"></script>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t\$(document).ready(function(){\r\n\t\t\t\t\$(\"#testandsave\").click(function(e){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\$(\".addborder\").removeClass(\"addborder\");\r\n\t\t\t\t\tcounter = 0;\r\n\t\t\t\t\t\$( \".commonclass\" ).each(function( index ) {\r\n\t\t\t\t\t\tval = \$(this).val();\r\n\t\t\t\t\t\tif(val != \"\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcounter = Number(counter)+Number(1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\$(this).addClass(\"addborder\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif(counter >= 4)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tjQuery.ajax({\r\n\t\t\t\t\t        type:\"POST\",\r\n\t\t\t\t\t        url:\"includes/outer-ajax.php\",\r\n\t\t\t\t\t        dataType:\"text\",\r\n\t\t\t\t\t        data:{\r\n\t\t\t\t\t        action:'testandsavedetails',\r\n\t\t\t\t\t        hostname:\$.trim(\$(\"#hostname\").val()),\r\n\t\t\t\t\t        dbname:\$.trim(\$(\"#dbname\").val()),\r\n\t\t\t\t\t        dbusername:\$.trim(\$(\"#dbusername\").val()),\r\n\t\t\t\t\t        dbpassword:\$.trim(\$(\"#dbpassword\").val()),\r\n\t\t\t\t\t        port:\$.trim(\$(\"#port\").val())\r\n\t\t\t\t\t        },  \r\n\t\t\t\t\t        success:function(response){\r\n\t\t\t\t        \t\tvar obj = jQuery.parseJSON(response);\r\n\t\t\t\t\t\t        \tif(obj.result == \"success\"){\r\n\t\t\t\t\t\t        \t\tonetimepassword = obj.data;\r\n\t\t\t\t\t\t        \t\t Swal.fire({\r\n\t\t\t\t\t\t           \t\t\t title: 'IMPORTANT NOTE!!',\r\n\t\t\t\t\t\t           \t\t\t html: 'Your Database Details are saved successfully be sure to delete this file once you complete the data base dbconfiguration.php and check the permission of the dbinfo.php .<br> Save your detials Username <b>admin</b> and onetime password <b>'+onetimepassword+'</b> and change after first use.',\r\n\t\t\t\t\t\t\t\t            icon: 'success',\r\n\t\t\t\t\t\t\t\t            closeOnClickOutside: false,\r\n\t\t\t\t\t\t\t\t            dangerMode: true,\r\n\t\t\t\t\t\t\t\t        })\r\n\t\t\t\t\t\t\t\t        .then((willDelete) => {\r\n\t\t\t\t\t\t\t\t          if (willDelete) {\r\n\t\t\t\t\t\t\t\t            window.location.href =  'admin/index.php';\r\n\t\t\t\t\t\t\t\t          }\r\n\t\t\t\t\t\t\t\t        });\r\n\t\t\t\t\t\t        \t}else{\r\n\t\t\t\t\t\t        \t\tSwal.fire({\r\n\t\t\t\t\t\t\t\t\t\t  position: 'center',\r\n\t\t\t\t\t\t\t\t\t\t  icon: 'error',\r\n\t\t\t\t\t\t\t\t\t\t  title: 'Incorrect Details! Unable to create Connection.',\r\n\t\t\t\t\t\t\t\t\t\t  showConfirmButton: false,\r\n\t\t\t\t\t\t\t\t\t\t  timer: 1500\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t        \t}\r\n\t\t\t\t\t        \t\t\t\t\t        \t\r\n\t\t\t\t\t        }\r\n\t\t\t\t\t      });\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t</script>\r\n\t</body>\r\n</html>";

?>